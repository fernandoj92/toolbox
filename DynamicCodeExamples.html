<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>AMIDST Toolbox 1.0 by amidst</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">AMIDST Toolbox 1.0</h1>
      <h2 class="project-tagline">A Java Toolbox for Analysis of MassIve Data STreams using Probabilistic Graphical Models</h2>
      <a href="https://github.com/amidst/toolbox" class="btn">View on GitHub</a>
      <a href="https://github.com/amidst/toolbox/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/amidst/toolbox/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="dynamic-bayesian-networks-code-examples" class="anchor" href="#dynamic-bayesian-networks-code-examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic Bayesian networks: code Examples<a name="documentation"></a>
</h2>

<ul>
<li><a href="#dynamicdatastreamsexample">Dynamic Data Streams</a></li>
<li><a href="#dynamicvariablesexample">Dynamic Random Variables</a></li>
<li>
<a href="#dynamicbnexample">Dynamic Bayesian Networks</a>

<ul>
<li><a href="#dynamicbnnohiddenexample">Creating Bayesian Networks</a></li>
<li><a href="#dynamicbnhiddenexample">Creating Bayesian Networks with latent variables</a></li>
<li><a href="#dynamicbnmodifyexample">Modifying Bayesian Networks</a></li>
</ul>
</li>
<li>
<a href="#dynamicioexample">Dynamic I/O Functionality</a>

<ul>
<li><a href="#dynamiciodatastreamsexample">I/O of Data Streams</a></li>
<li><a href="#dynamiciobnsexample">I/O of Bayesian Networks</a></li>
</ul>
</li>
<li>
<a href="#dynamicinferenceexample">Dynamic Inference Algorithms</a>

<ul>
<li><a href="#dynamicinferenceengingeexample">The Inference Engine</a></li>
<li><a href="#dynamicvmpexample">Variational Message Passing</a></li>
<li><a href="#dynamicisexample">Importance Sampling</a></li>
</ul>
</li>
<li>
<a href="#dynamiclearningexample">Dynamic Learning Algorithms</a>

<ul>
<li><a href="#dynamicmlexample">Maximum Likelihood</a></li>
<li><a href="#dynamicpmlexample">Parallel Maximum Likelihood</a></li>
<li><a href="#dynamicsvbexample">Streaming Variational Bayes</a></li>
<li><a href="#dynamicpsvbexample">Parallel Streaming Variational Bayes</a></li>
</ul>
</li>
</ul>

<h2>
<a id="dynamic-data-streams" class="anchor" href="#dynamic-data-streams" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic Data Streams<a name="dynamicdatastreamsexample"></a>
</h2>

<p>In this example we show how to use the main features of a <em>DataStream</em> object. More precisely,  we show  how to load a dynamic data stream and how to iterate over the <em>DynamicDataInstance</em> objects.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//Open the data stream using the class DynamicDataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DynamicDataInstance</span>&gt;</span> data <span class="pl-k">=</span> <span class="pl-smi">DynamicDataStreamLoader</span><span class="pl-k">.</span>loadFromFile(<span class="pl-s"><span class="pl-pds">"</span>datasets/dynamicNB-samples.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">//Access the attributes defining the data stream</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>Attributes defining the data set<span class="pl-pds">"</span></span>);
<span class="pl-k">for</span> (<span class="pl-smi">Attribute</span> attribute <span class="pl-k">:</span> data<span class="pl-k">.</span>getAttributes()) {
    <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(attribute<span class="pl-k">.</span>getName());
}
<span class="pl-smi">Attribute</span> classVar <span class="pl-k">=</span> data<span class="pl-k">.</span>getAttributes()<span class="pl-k">.</span>getAttributeByName(<span class="pl-s"><span class="pl-pds">"</span>ClassVar<span class="pl-pds">"</span></span>);

<span class="pl-c">//Iterate over dynamic data instances</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>1. Iterating over samples using a for loop<span class="pl-pds">"</span></span>);
<span class="pl-k">for</span> (<span class="pl-smi">DynamicDataInstance</span> dataInstance <span class="pl-k">:</span> data) {
    <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>SequenceID = <span class="pl-pds">"</span></span><span class="pl-k">+</span>dataInstance<span class="pl-k">.</span>getSequenceID()<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span>, TimeID = <span class="pl-pds">"</span></span><span class="pl-k">+</span>dataInstance<span class="pl-k">.</span>getTimeID());
    <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>The value of attribute A for the current data instance is: <span class="pl-pds">"</span></span> <span class="pl-k">+</span>
        dataInstance<span class="pl-k">.</span>getValue(classVar));
}</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h2>
<a id="dynamic-random-variables" class="anchor" href="#dynamic-random-variables" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic Random Variables<a name="dynamicvariablesexample"></a>
</h2>

<p>This example show the basic functionalities related to dynamic variables.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//Create an empty DynamicVariables object</span>
<span class="pl-smi">DynamicVariables</span> variables <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">DynamicVariables</span>();

<span class="pl-c">//Invoke the "new" methods of the object DynamicVariables to create new dynamic variables.</span>

<span class="pl-c">//Create a Gaussian dynamic variables</span>
<span class="pl-smi">Variable</span> gaussianVar <span class="pl-k">=</span> variables<span class="pl-k">.</span>newGaussianDynamicVariable(<span class="pl-s"><span class="pl-pds">"</span>GaussianVar<span class="pl-pds">"</span></span>);

<span class="pl-c">//Create a Multinomial dynamic variable with two states</span>
<span class="pl-smi">Variable</span> multinomialVar <span class="pl-k">=</span> variables<span class="pl-k">.</span>newMultinomialDynamicVariable(<span class="pl-s"><span class="pl-pds">"</span>MultinomialVar<span class="pl-pds">"</span></span>, <span class="pl-c1">2</span>);

<span class="pl-c">//Create a Multinomial dynamic variable with two states: TRUE and FALSE</span>
<span class="pl-smi">Variable</span> multinomialVar2 <span class="pl-k">=</span> variables<span class="pl-k">.</span>newMultinomialDynamicVariable(<span class="pl-s"><span class="pl-pds">"</span>MultinomialVar2<span class="pl-pds">"</span></span>, <span class="pl-smi">Arrays</span><span class="pl-k">.</span>asList(<span class="pl-s"><span class="pl-pds">"</span>TRUE, FALSE<span class="pl-pds">"</span></span>));

<span class="pl-c">//All dynamic Variables have an interface variable</span>
<span class="pl-smi">Variable</span> gaussianVarInt <span class="pl-k">=</span> gaussianVar<span class="pl-k">.</span>getInterfaceVariable();
<span class="pl-smi">Variable</span> multinomialVarInt <span class="pl-k">=</span> multinomialVar<span class="pl-k">.</span>getInterfaceVariable();

<span class="pl-c">//Get the "main" Variable associated with each interface variable through the DynamicVariable object</span>
<span class="pl-smi">Variable</span> mainMultinomialVar <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableFromInterface(multinomialVarInt);

<span class="pl-c">//Check whether a variable is an interface variable</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>Is Variable <span class="pl-pds">"</span></span><span class="pl-k">+</span>gaussianVar<span class="pl-k">.</span>getName()<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span> an interface variable? <span class="pl-pds">"</span></span>
                <span class="pl-k">+</span>gaussianVar<span class="pl-k">.</span>isInterfaceVariable());
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>Is Variable <span class="pl-pds">"</span></span><span class="pl-k">+</span>gaussianVarInt<span class="pl-k">.</span>getName()<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span> an interface variable? <span class="pl-pds">"</span></span>
                <span class="pl-k">+</span>gaussianVarInt<span class="pl-k">.</span>isInterfaceVariable());

<span class="pl-c">//Check whether a variable is a dynamic variable</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>Is Variable <span class="pl-pds">"</span></span><span class="pl-k">+</span>multinomialVar<span class="pl-k">.</span>getName()<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span> a dynamic variable? <span class="pl-pds">"</span></span>
                <span class="pl-k">+</span>gaussianVar<span class="pl-k">.</span>isDynamicVariable());</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h2>
<a id="dynamic-bayesian-networks" class="anchor" href="#dynamic-bayesian-networks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic Bayesian Networks<a name="dynamicbnexample"></a>
</h2>

<h3>
<a id="creating-dynamic-bayesian-networks" class="anchor" href="#creating-dynamic-bayesian-networks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating dynamic Bayesian networks<a name="bnnohiddenexample"></a>
</h3>

<p>This example creates a dynamic BN, from a dynamic data stream, with randomly generated probability distributions, then saves it to a file.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//Open the data stream using the static class DynamicDataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DynamicDataInstance</span>&gt;</span> data <span class="pl-k">=</span> <span class="pl-smi">DynamicDataStreamLoader</span><span class="pl-k">.</span>loadFromFile(
                <span class="pl-s"><span class="pl-pds">"</span>datasets/syntheticDataDiscrete.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">/**</span>
<span class="pl-c">* 1. Once the data is loaded, we create a random variable for each of the attributes (i.e. data columns)</span>
<span class="pl-c">* in our data.</span>
<span class="pl-c">*</span>
<span class="pl-c">* 2. {@link DynamicVariables} is the class for doing that. It takes a list of Attributes and internally creates</span>
<span class="pl-c">* all the variables. We create the variables using DynamicVariables class to guarantee that each variable</span>
<span class="pl-c">* has a different ID number and make it transparent for the user. Each random variable has an associated</span>
<span class="pl-c">* interface variable.</span>
<span class="pl-c">*</span>
<span class="pl-c">* 3. We can extract the Variable objects by using the method getVariableByName();</span>
<span class="pl-c">*/</span>
<span class="pl-smi">DynamicVariables</span> dynamicVariables <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">DynamicVariables</span>(data<span class="pl-k">.</span>getAttributes());
<span class="pl-smi">DynamicDAG</span> dynamicDAG <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">DynamicDAG</span>(dynamicVariables);

<span class="pl-smi">Variable</span> <span class="pl-smi">A</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> <span class="pl-smi">B</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>B<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> <span class="pl-smi">C</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> <span class="pl-smi">D</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>D<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> <span class="pl-smi">E</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>E<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> <span class="pl-smi">G</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>G<span class="pl-pds">"</span></span>);

<span class="pl-smi">Variable</span> <span class="pl-smi">A_Interface</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getInterfaceVariable(<span class="pl-smi">A</span>);
<span class="pl-smi">Variable</span> <span class="pl-smi">B_Interface</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getInterfaceVariable(<span class="pl-smi">B</span>);

<span class="pl-c">//Note that C_Interface and D_Interface are also created although they will not be used</span>
<span class="pl-c">//(we will not add temporal dependencies)</span>

<span class="pl-smi">Variable</span> <span class="pl-smi">E_Interface</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getInterfaceVariable(<span class="pl-smi">E</span>);
<span class="pl-smi">Variable</span> <span class="pl-smi">G_Interface</span> <span class="pl-k">=</span> dynamicVariables<span class="pl-k">.</span>getInterfaceVariable(<span class="pl-smi">G</span>);

<span class="pl-c">// Example of the dynamic DAG structure</span>
<span class="pl-c">// Time 0: Parents at time 0 are automatically created when adding parents at time T</span>
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">B</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">A</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">C</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">A</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">D</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">A</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">E</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">A</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">G</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">A</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">A</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">A_Interface</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">B</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">B_Interface</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">E</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">E_Interface</span>);
dynamicDAG<span class="pl-k">.</span>getParentSetTimeT(<span class="pl-smi">G</span>)<span class="pl-k">.</span>addParent(<span class="pl-smi">G_Interface</span>);

<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(dynamicDAG<span class="pl-k">.</span>toString());

<span class="pl-c">/**</span>
<span class="pl-c">* 1. We now create the Dynamic Bayesian network from the previous Dynamic DAG.</span>
<span class="pl-c">*</span>
<span class="pl-c">* 2. The DBN object is created from the DynamicDAG. It automatically looks at the distribution type</span>
<span class="pl-c">* of each variable and their parents to initialize the Distributions objects that are stored</span>
<span class="pl-c">* inside (i.e. Multinomial, Normal, CLG, etc). The parameters defining these distributions are</span>
<span class="pl-c">* properly initialized.</span>
<span class="pl-c">*</span>
<span class="pl-c">* 3. The network is printed and we can have a look at the kind of distributions stored in the DBN object.</span>
<span class="pl-c">*/</span>
<span class="pl-smi">DynamicBayesianNetwork</span> dbn <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">DynamicBayesianNetwork</span>(dynamicDAG);
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>printf(dbn<span class="pl-k">.</span>toString());

<span class="pl-c">/**</span>
<span class="pl-c">* Finally teh Bayesian network is saved to a file.</span>
<span class="pl-c">*/</span>
<span class="pl-smi">DynamicBayesianNetworkWriter</span><span class="pl-k">.</span>saveToFile(dbn, <span class="pl-s"><span class="pl-pds">"</span>networks/DBNExample.bn<span class="pl-pds">"</span></span>);</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="creating-dynamic-bayesian-networks-with-latent-variables-" class="anchor" href="#creating-dynamic-bayesian-networks-with-latent-variables-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating Dynamic Bayesian Networks with Latent Variables <a name="dynamicbnhiddenexample"></a>
</h3>

<p>In this example, we simply show how to create a BN model with hidden variables. We simply create a BN for clustering, i.e.,  a naive-Bayes like structure with a single common hidden variable acting as parant of all the observable variables.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We can open the data stream using the static class DataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DataInstance</span>&gt;</span> data <span class="pl-k">=</span> <span class="pl-smi">DataStreamLoader</span><span class="pl-k">.</span>openFromFile(<span class="pl-s"><span class="pl-pds">"</span>datasets/syntheticData.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">/**</span>
<span class="pl-c"> * 1. Once the data is loaded, we create a random variable for each of the attributes (i.e. data columns)</span>
<span class="pl-c"> * in our data.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 2. {@link Variables} is the class for doing that. It takes a list of Attributes and internally creates</span>
<span class="pl-c"> * all the variables. We create the variables using Variables class to guarantee that each variable</span>
<span class="pl-c"> * has a different ID number and make it transparent for the user.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 3. We can extract the Variable objects by using the method getVariableByName();</span>
<span class="pl-c"> */</span>
<span class="pl-smi">Variables</span> variables <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Variables</span>(data<span class="pl-k">.</span>getAttributes());

<span class="pl-smi">Variable</span> a <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> b <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>B<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> c <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> d <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>D<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> e <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>E<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> g <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>G<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> h <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>H<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> i <span class="pl-k">=</span> variables<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>I<span class="pl-pds">"</span></span>);

<span class="pl-c">/**</span>
<span class="pl-c"> * 1. We create the hidden variable. For doing that we make use of the method "newMultionomialVariable". When</span>
<span class="pl-c"> * a variable is created from an Attribute object, it contains all the information we need (e.g.</span>
<span class="pl-c"> * the name, the type, etc). But hidden variables does not have an associated attribute</span>
<span class="pl-c"> * and, for this reason, we use now this to provide this information.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 2. Using the "newMultionomialVariable" method, we define a variable called HiddenVar, which is</span>
<span class="pl-c"> * not associated to any attribute and, then, it is a latent variable, its state space is a finite set with two elements, and its</span>
<span class="pl-c"> * distribution type is multinomial.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 3. We finally create the hidden variable using the method "newVariable".</span>
<span class="pl-c"> */</span>

<span class="pl-smi">Variable</span> hidden <span class="pl-k">=</span> variables<span class="pl-k">.</span>newMultionomialVariable(<span class="pl-s"><span class="pl-pds">"</span>HiddenVar<span class="pl-pds">"</span></span>, <span class="pl-smi">Arrays</span><span class="pl-k">.</span>asList(<span class="pl-s"><span class="pl-pds">"</span>TRUE<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>FALSE<span class="pl-pds">"</span></span>));

<span class="pl-c">/**</span>
<span class="pl-c"> * 1. Once we have defined your {@link Variables} object, including the latent variable,</span>
<span class="pl-c"> * the next step is to create a DAG structure over this set of variables.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 2. To add parents to each variable, we first recover the ParentSet object by the method</span>
<span class="pl-c"> * getParentSet(Variable var) and then call the method addParent(Variable var).</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 3. We just put the hidden variable as parent of all the other variables. Following a naive-Bayes</span>
<span class="pl-c"> * like structure.</span>
<span class="pl-c"> */</span>
<span class="pl-smi">DAG</span> dag <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">DAG</span>(variables);

dag<span class="pl-k">.</span>getParentSet(a)<span class="pl-k">.</span>addParent(hidden);
dag<span class="pl-k">.</span>getParentSet(b)<span class="pl-k">.</span>addParent(hidden);
dag<span class="pl-k">.</span>getParentSet(c)<span class="pl-k">.</span>addParent(hidden);
dag<span class="pl-k">.</span>getParentSet(d)<span class="pl-k">.</span>addParent(hidden);
dag<span class="pl-k">.</span>getParentSet(e)<span class="pl-k">.</span>addParent(hidden);
dag<span class="pl-k">.</span>getParentSet(g)<span class="pl-k">.</span>addParent(hidden);
dag<span class="pl-k">.</span>getParentSet(h)<span class="pl-k">.</span>addParent(hidden);
dag<span class="pl-k">.</span>getParentSet(i)<span class="pl-k">.</span>addParent(hidden);

<span class="pl-c">/**</span>
<span class="pl-c"> * We print the graph to see if is properly created.</span>
<span class="pl-c"> */</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(dag<span class="pl-k">.</span>toString());

<span class="pl-c">/**</span>
<span class="pl-c"> * 1. We now create the Bayesian network from the previous DAG.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 2. The BN object is created from the DAG. It automatically looks at the distribution type</span>
<span class="pl-c"> * of each variable and their parents to initialize the Distributions objects that are stored</span>
<span class="pl-c"> * inside (i.e. Multinomial, Normal, CLG, etc). The parameters defining these distributions are</span>
<span class="pl-c"> * properly initialized.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * 3. The network is printed and we can have look at the kind of distributions stored in the BN object.</span>
<span class="pl-c"> */</span>
<span class="pl-smi">BayesianNetwork</span> bn <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">BayesianNetwork</span>(dag);
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bn<span class="pl-k">.</span>toString());

<span class="pl-c">/**</span>
<span class="pl-c"> * Finally teh Bayesian network is saved to a file.</span>
<span class="pl-c"> */</span>
<span class="pl-smi">BayesianNetworkWriter</span><span class="pl-k">.</span>saveToFile(bn, <span class="pl-s"><span class="pl-pds">"</span>networks/BNHiddenExample.bn<span class="pl-pds">"</span></span>);</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="modifying-dynamic-bayesian-networks-" class="anchor" href="#modifying-dynamic-bayesian-networks-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Modifying Dynamic Bayesian Networks <a name="dynamicbnmodifyexample"></a>
</h3>

<p>In this example we show how to access and modify the conditional probabilities of a Bayesian network model.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We first generate a Bayesian network with one multinomial, one Gaussian variable and one link.</span>
<span class="pl-smi">BayesianNetworkGenerator</span><span class="pl-k">.</span>setNumberOfGaussianVars(<span class="pl-c1">1</span>);
<span class="pl-smi">BayesianNetworkGenerator</span><span class="pl-k">.</span>setNumberOfMultinomialVars(<span class="pl-c1">1</span>,<span class="pl-c1">2</span>);
<span class="pl-smi">BayesianNetworkGenerator</span><span class="pl-k">.</span>setNumberOfLinks(<span class="pl-c1">1</span>);

<span class="pl-smi">BayesianNetwork</span> bn <span class="pl-k">=</span> <span class="pl-smi">BayesianNetworkGenerator</span><span class="pl-k">.</span>generateBayesianNetwork();

<span class="pl-c">//We print the randomly generated Bayesian networks</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bn<span class="pl-k">.</span>toString());

<span class="pl-c">//We first access the variable we are interested in</span>
<span class="pl-smi">Variable</span> multiVar <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>DiscreteVar0<span class="pl-pds">"</span></span>);

<span class="pl-c">//Using the above variable we can get the associated distribution and modify it</span>
<span class="pl-smi">Multinomial</span> multinomial <span class="pl-k">=</span> bn<span class="pl-k">.</span>getConditionalDistribution(multiVar);
multinomial<span class="pl-k">.</span>setProbabilities(<span class="pl-k">new</span> <span class="pl-smi">double</span>[]{<span class="pl-c1">0.2</span>, <span class="pl-c1">0.8</span>});

<span class="pl-c">//Same than before but accessing the another variable</span>
<span class="pl-smi">Variable</span> normalVar <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>GaussianVar0<span class="pl-pds">"</span></span>);

<span class="pl-c">//In this case, the conditional distribtuion is of the type "Normal given Multinomial Parents"</span>
<span class="pl-smi">Normal_MultinomialParents</span> normalMultiDist <span class="pl-k">=</span> bn<span class="pl-k">.</span>getConditionalDistribution(normalVar);
normalMultiDist<span class="pl-k">.</span>getNormal(<span class="pl-c1">0</span>)<span class="pl-k">.</span>setMean(<span class="pl-c1">1.0</span>);
normalMultiDist<span class="pl-k">.</span>getNormal(<span class="pl-c1">0</span>)<span class="pl-k">.</span>setVariance(<span class="pl-c1">1.0</span>);

normalMultiDist<span class="pl-k">.</span>getNormal(<span class="pl-c1">1</span>)<span class="pl-k">.</span>setMean(<span class="pl-c1">0.0</span>);
normalMultiDist<span class="pl-k">.</span>getNormal(<span class="pl-c1">1</span>)<span class="pl-k">.</span>setVariance(<span class="pl-c1">1.0</span>);

<span class="pl-c">//We print modified Bayesian network</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bn<span class="pl-k">.</span>toString());</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h2>
<a id="io-functionality-" class="anchor" href="#io-functionality-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>I/O Functionality <a name="dynamicioexample"></a>
</h2>

<h3>
<a id="io-of-data-streams-" class="anchor" href="#io-of-data-streams-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>I/O of Data Streams <a name="dynamiciodatastreamsexample"></a>
</h3>

<p>In this example we show how to load and save data sets from <a href="http://www.cs.waikato.ac.nz/ml/weka/arff.html">.arff</a> files. </p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We can open the data stream using the static class DataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DataInstance</span>&gt;</span> data <span class="pl-k">=</span> <span class="pl-smi">DataStreamLoader</span><span class="pl-k">.</span>openFromFile(<span class="pl-s"><span class="pl-pds">"</span>datasets/syntheticData.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">//We can save this data set to a new file using the static class DataStreamWriter</span>
<span class="pl-smi">DataStreamWriter</span><span class="pl-k">.</span>writeDataToFile(data, <span class="pl-s"><span class="pl-pds">"</span>datasets/tmp.arff<span class="pl-pds">"</span></span>);</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="dynamic-io-of-bayesian-networks-" class="anchor" href="#dynamic-io-of-bayesian-networks-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic I/O of Bayesian Networks <a name="dynamiciobnsexample"></a>
</h3>

<p>In this example we show how to load and save Bayesian networks models for a binary file with ".bn" extension. In this toolbox Bayesian networks models are saved as serialized objects.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We can load a Bayesian network using the static class BayesianNetworkLoader</span>
<span class="pl-smi">BayesianNetwork</span> bn <span class="pl-k">=</span> <span class="pl-smi">BayesianNetworkLoader</span><span class="pl-k">.</span>loadFromFile(<span class="pl-s"><span class="pl-pds">"</span>./networks/WasteIncinerator.bn<span class="pl-pds">"</span></span>);

<span class="pl-c">//Now we print the loaded model</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bn<span class="pl-k">.</span>toString());

<span class="pl-c">//Now we change the parameters of the model</span>
bn<span class="pl-k">.</span>randomInitialization(<span class="pl-k">new</span> <span class="pl-smi">Random</span>(<span class="pl-c1">0</span>));

<span class="pl-c">//We can save this Bayesian network to using the static class BayesianNetworkWriter</span>
<span class="pl-smi">BayesianNetworkWriter</span><span class="pl-k">.</span>saveToFile(bn, <span class="pl-s"><span class="pl-pds">"</span>networks/tmp.bn<span class="pl-pds">"</span></span>);</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h2>
<a id="inference-algorithms-" class="anchor" href="#inference-algorithms-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Inference Algorithms <a name="dynamicinferenceexample"></a>
</h2>

<h3>
<a id="the-inference-engine-" class="anchor" href="#the-inference-engine-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Inference Engine <a name="dynamicinferenceengingeexample"></a>
</h3>

<p>This example show how to perform inference in a Bayesian network model using the InferenceEngine static class. This class aims to be a straigthfoward way to perform queries over a Bayesian network model. By the default the \textit{VMP} inference method is invoked.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We first load the WasteIncinerator bayesian network which has multinomial </span>
<span class="pl-c">//and Gaussian variables.</span>
<span class="pl-smi">BayesianNetwork</span> bn <span class="pl-k">=</span> <span class="pl-smi">BayesianNetworkLoader</span><span class="pl-k">.</span>loadFromFile(<span class="pl-s"><span class="pl-pds">"</span>./networks/WasteIncinerator.bn<span class="pl-pds">"</span></span>);

<span class="pl-c">//We recover the relevant variables for this example: Mout which is normally </span>
<span class="pl-c">//distributed, and W which is multinomial.</span>
<span class="pl-smi">Variable</span> varMout <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>Mout<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> varW <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>W<span class="pl-pds">"</span></span>);

<span class="pl-c">//Set the evidence.</span>
<span class="pl-smi">Assignment</span> assignment <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">HashMapAssignment</span>(<span class="pl-c1">1</span>);
assignment<span class="pl-k">.</span>setValue(varW,<span class="pl-c1">0</span>);

<span class="pl-c">//Then we query the posterior of</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(Mout|W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-smi">InferenceEngine</span><span class="pl-k">.</span>getPosterior(varMout, bn, assignment));

<span class="pl-c">//Or some more refined queries</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(0.7&lt;Mout&lt;6.59 | W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> 
 <span class="pl-smi">InferenceEngine</span><span class="pl-k">.</span>getExpectedValue(varMout, bn, v <span class="pl-k">-</span><span class="pl-k">&gt;</span> (<span class="pl-c1">0.7</span> <span class="pl-k">&lt;</span> v <span class="pl-k">&amp;&amp;</span> v <span class="pl-k">&lt;</span> <span class="pl-c1">6.59</span>) <span class="pl-k">?</span> <span class="pl-c1">1.0</span> <span class="pl-k">:</span> <span class="pl-c1">0.0</span> ));</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="variational-message-passing-" class="anchor" href="#variational-message-passing-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variational Message Passing <a name="dynamicvmpexample"></a>
</h3>

<p>This example we show how to perform inference on a general Bayesian network using the Variational Message Passing (VMP)
algorithm detailed in</p>

<blockquote>
<p>Winn, J. M., Bishop, C. M. (2005). Variational message passing. In Journal of Machine Learning Research (pp. 661-694).</p>
</blockquote>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We first load the WasteIncinerator bayesian network which has multinomial </span>
<span class="pl-c">//and Gaussian variables.</span>
<span class="pl-smi">BayesianNetwork</span> bn <span class="pl-k">=</span> <span class="pl-smi">BayesianNetworkLoader</span><span class="pl-k">.</span>loadFromFile(<span class="pl-s"><span class="pl-pds">"</span>./networks/WasteIncinerator.bn<span class="pl-pds">"</span></span>);

<span class="pl-c">//We recover the relevant variables for this example: Mout which is normally </span>
<span class="pl-c">//distributed, and W which is multinomial.</span>
<span class="pl-smi">Variable</span> varMout <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>Mout<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> varW <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>W<span class="pl-pds">"</span></span>);

<span class="pl-c">//First we create an instance of a inference algorithm. In this case, we use </span>
<span class="pl-c">//the VMP class.</span>
<span class="pl-smi">InferenceAlgorithm</span> inferenceAlgorithm <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">VMP</span>();

<span class="pl-c">//Then, we set the BN model</span>
inferenceAlgorithm<span class="pl-k">.</span>setModel(bn);

<span class="pl-c">//If exists, we also set the evidence.</span>
<span class="pl-smi">Assignment</span> assignment <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">HashMapAssignment</span>(<span class="pl-c1">1</span>);
assignment<span class="pl-k">.</span>setValue(varW,<span class="pl-c1">0</span>);
inferenceAlgorithm<span class="pl-k">.</span>setEvidence(assignment);

<span class="pl-c">//Then we run inference</span>
inferenceAlgorithm<span class="pl-k">.</span>runInference();

<span class="pl-c">//Then we query the posterior of</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(Mout|W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> inferenceAlgorithm<span class="pl-k">.</span>getPosterior(varMout));

<span class="pl-c">//Or some more refined queries</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(0.7&lt;Mout&lt;6.59 | W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> 
 inferenceAlgorithm<span class="pl-k">.</span>getExpectedValue(varMout, v <span class="pl-k">-</span><span class="pl-k">&gt;</span> (<span class="pl-c1">0.7</span> <span class="pl-k">&lt;</span> v <span class="pl-k">&amp;&amp;</span> v <span class="pl-k">&lt;</span> <span class="pl-c1">6.59</span>) <span class="pl-k">?</span> <span class="pl-c1">1.0</span> <span class="pl-k">:</span> <span class="pl-c1">0.0</span> ));

<span class="pl-c">//We can also compute the probability of the evidence</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-smi">Math</span><span class="pl-k">.</span>exp(inferenceAlgorithm<span class="pl-k">.</span>getLogProbabilityOfEvidence()));</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="importance-sampling-" class="anchor" href="#importance-sampling-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Importance Sampling <a name="isexample"></a>
</h3>

<p>This example we show how to perform inference on a general Bayesian network using an importance sampling
algorithm detailed in</p>

<blockquote>
<p>Fung, R., Chang, K. C. (2013). Weighing and integrating evidence for stochastic simulation in Bayesian networks. arXiv preprint arXiv:1304.1504.</p>
</blockquote>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We first load the WasteIncinerator bayesian network which has multinomial </span>
<span class="pl-c">//and Gaussian variables.</span>
<span class="pl-smi">BayesianNetwork</span> bn <span class="pl-k">=</span> <span class="pl-smi">BayesianNetworkLoader</span><span class="pl-k">.</span>loadFromFile(<span class="pl-s"><span class="pl-pds">"</span>./networks/WasteIncinerator.bn<span class="pl-pds">"</span></span>);

<span class="pl-c">//We recover the relevant variables for this example: Mout which is normally </span>
<span class="pl-c">//distributed, and W which is multinomial.</span>
<span class="pl-smi">Variable</span> varMout <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>Mout<span class="pl-pds">"</span></span>);
<span class="pl-smi">Variable</span> varW <span class="pl-k">=</span> bn<span class="pl-k">.</span>getStaticVariables()<span class="pl-k">.</span>getVariableByName(<span class="pl-s"><span class="pl-pds">"</span>W<span class="pl-pds">"</span></span>);

<span class="pl-c">//First we create an instance of a inference algorithm. In this case, we use </span>
<span class="pl-c">//the ImportanceSampling class.</span>
<span class="pl-smi">InferenceAlgorithm</span> inferenceAlgorithm <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">ImportanceSampling</span>();

<span class="pl-c">//Then, we set the BN model</span>
inferenceAlgorithm<span class="pl-k">.</span>setModel(bn);

<span class="pl-c">//If exists, we also set the evidence.</span>
<span class="pl-smi">Assignment</span> assignment <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">HashMapAssignment</span>(<span class="pl-c1">1</span>);
assignment<span class="pl-k">.</span>setValue(varW,<span class="pl-c1">0</span>);
inferenceAlgorithm<span class="pl-k">.</span>setEvidence(assignment);

<span class="pl-c">//We can also set to be run in parallel on multicore CPUs</span>
inferenceAlgorithm<span class="pl-k">.</span>setParallelMode(<span class="pl-c1">true</span>);

<span class="pl-c">//Then we run inference</span>
inferenceAlgorithm<span class="pl-k">.</span>runInference();

<span class="pl-c">//Then we query the posterior of</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(Mout|W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> inferenceAlgorithm<span class="pl-k">.</span>getPosterior(varMout));

<span class="pl-c">//Or some more refined queries</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(0.7&lt;Mout&lt;6.59 | W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> 
 inferenceAlgorithm<span class="pl-k">.</span>getExpectedValue(varMout, v <span class="pl-k">-</span><span class="pl-k">&gt;</span> (<span class="pl-c1">0.7</span> <span class="pl-k">&lt;</span> v <span class="pl-k">&amp;&amp;</span> v <span class="pl-k">&lt;</span> <span class="pl-c1">6.59</span>) <span class="pl-k">?</span> <span class="pl-c1">1.0</span> <span class="pl-k">:</span> <span class="pl-c1">0.0</span> ));

<span class="pl-c">//We can also compute the probability of the evidence</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>P(W=0) = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-smi">Math</span><span class="pl-k">.</span>exp(inferenceAlgorithm<span class="pl-k">.</span>getLogProbabilityOfEvidence()));</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h2>
<a id="dynamic-learning-algorithms-" class="anchor" href="#dynamic-learning-algorithms-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic Learning Algorithms <a name="dynamiclearningexample"></a>
</h2>

<h3>
<a id="maximum-likelihood-" class="anchor" href="#maximum-likelihood-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Maximum Likelihood <a name="mlexample"></a>
</h3>

<p>This other example shows how to learn incrementally the parameters of a Bayesian network using data batches,</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We can open the data stream using the static class DataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DataInstance</span>&gt;</span> data <span class="pl-k">=</span> 
                  <span class="pl-smi">DataStreamLoader</span><span class="pl-k">.</span>openFromFile(<span class="pl-s"><span class="pl-pds">"</span>datasets/WasteIncineratorSample.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">//We create a ParameterLearningAlgorithm object with the MaximumLikehood builder</span>
<span class="pl-smi">ParameterLearningAlgorithm</span> parameterLearningAlgorithm <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">ParallelMaximumLikelihood</span>();

<span class="pl-c">//We fix the DAG structure</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setDAG(getNaiveBayesStructure(data,<span class="pl-c1">0</span>));

<span class="pl-c">//We should invoke this method before processing any data</span>
parameterLearningAlgorithm<span class="pl-k">.</span>initLearning();


<span class="pl-c">//Then we show how we can perform parameter learnig by a sequential updating of data batches.</span>
<span class="pl-k">for</span> (<span class="pl-k">DataOnMemory&lt;<span class="pl-smi">DataInstance</span>&gt;</span> batch <span class="pl-k">:</span> data<span class="pl-k">.</span>iterableOverBatches(<span class="pl-c1">100</span>)){
    parameterLearningAlgorithm<span class="pl-k">.</span>updateModel(batch);
}

<span class="pl-c">//And we get the model</span>
<span class="pl-smi">BayesianNetwork</span> bnModel <span class="pl-k">=</span> parameterLearningAlgorithm<span class="pl-k">.</span>getLearntBayesianNetwork();

<span class="pl-c">//We print the model</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bnModel<span class="pl-k">.</span>toString());</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="parallel-maximum-likelihood-" class="anchor" href="#parallel-maximum-likelihood-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Parallel Maximum Likelihood <a name="dynamicpmlexample"></a>
</h3>

<p>This example shows how to learn in parallel the parameters of a Bayesian network from a stream of data using maximum likelihood.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We can open the data stream using the static class DataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DataInstance</span>&gt;</span> data <span class="pl-k">=</span> 
           <span class="pl-smi">DataStreamLoader</span><span class="pl-k">.</span>openFromFile(<span class="pl-s"><span class="pl-pds">"</span>datasets/syntheticData.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">//We create a MaximumLikelihood object with the MaximumLikehood builder</span>
<span class="pl-smi">MaximumLikelihood</span> parameterLearningAlgorithm <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">MaximumLikelihood</span>();

<span class="pl-c">//We activate the parallel mode.</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setParallelMode(<span class="pl-c1">true</span>);

<span class="pl-c">//We fix the DAG structure</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setDAG(getNaiveBayesStructure(data,<span class="pl-c1">0</span>));

<span class="pl-c">//We set the batch size which will be employed to learn the model in parallel</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setBatchSize(<span class="pl-c1">100</span>);

<span class="pl-c">//We set the data which is going to be used for leaning the parameters</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setDataStream(data);

<span class="pl-c">//We perform the learning</span>
parameterLearningAlgorithm<span class="pl-k">.</span>runLearning();

<span class="pl-c">//And we get the model</span>
<span class="pl-smi">BayesianNetwork</span> bnModel <span class="pl-k">=</span> parameterLearningAlgorithm<span class="pl-k">.</span>getLearntBayesianNetwork();

<span class="pl-c">//We print the model</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bnModel<span class="pl-k">.</span>toString());</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="streaming-variational-bayes-" class="anchor" href="#streaming-variational-bayes-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Streaming Variational Bayes <a name="dynamicsvbexample"></a>
</h3>

<p>This example shows how to learn incrementally the parameters of a Bayesian network from a stream of data with a Bayesian approach using the following algorithm,</p>

<blockquote>
<p>Broderick, T., Boyd, N., Wibisono, A., Wilson, A. C., &amp; Jordan, M. I. (2013). Streaming variational Bayes. 
In Advances in Neural Information Processing Systems (pp. 1727-1735).</p>
</blockquote>

<p>In this second example we show a alternative implementation which explicitly updates the model by batches by using the class <em>SVB</em>.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We can open the data stream using the static class DataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DataInstance</span>&gt;</span> data <span class="pl-k">=</span> 
                      <span class="pl-smi">DataStreamLoader</span><span class="pl-k">.</span>openFromFile(<span class="pl-s"><span class="pl-pds">"</span>datasets/WasteIncineratorSample.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">//We create a StreamingVariationalBayesVMP object</span>
<span class="pl-smi">StreamingVariationalBayesVMP</span> parameterLearningAlgorithm <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">StreamingVariationalBayesVMP</span>();

<span class="pl-c">//We fix the DAG structure, which is a Naive Bayes with a </span>
<span class="pl-c">//global latent binary variable</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setDAG(getHiddenNaiveBayesStructure(data));

<span class="pl-c">//We fix the size of the window, which must be equal to the size of the data batches </span>
<span class="pl-c">//we use for learning</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setWindowsSize(<span class="pl-c1">5</span>);

<span class="pl-c">//We can activate the output</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setOutput(<span class="pl-c1">true</span>);

<span class="pl-c">//We should invoke this method before processing any data</span>
parameterLearningAlgorithm<span class="pl-k">.</span>initLearning();

<span class="pl-c">//Then we show how we can perform parameter learnig by a sequential updating of </span>
<span class="pl-c">//data batches.</span>
<span class="pl-k">for</span> (<span class="pl-k">DataOnMemory&lt;<span class="pl-smi">DataInstance</span>&gt;</span> batch <span class="pl-k">:</span> data<span class="pl-k">.</span>iterableOverBatches(<span class="pl-c1">5</span>)){
    parameterLearningAlgorithm<span class="pl-k">.</span>updateModel(batch);
}

<span class="pl-c">//And we get the model</span>
<span class="pl-smi">BayesianNetwork</span> bnModel <span class="pl-k">=</span> parameterLearningAlgorithm<span class="pl-k">.</span>getLearntBayesianNetwork();

<span class="pl-c">//We print the model</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bnModel<span class="pl-k">.</span>toString());</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

<h3>
<a id="parallel-streaming-variational-bayes-" class="anchor" href="#parallel-streaming-variational-bayes-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Parallel Streaming Variational Bayes <a name="dynamicpsvbexample"></a>
</h3>

<p>This example shows how to learn in the parameters of a Bayesian network from a stream of data with a Bayesian
approach using the parallel version  of the SVB algorithm, </p>

<blockquote>
<p>Broderick, T., Boyd, N., Wibisono, A., Wilson, A. C., &amp; Jordan, M. I. (2013). Streaming variational Bayes. 
In Advances in Neural Information Processing Systems (pp. 1727-1735).</p>
</blockquote>

<div class="highlight highlight-source-java"><pre><span class="pl-c">//We can open the data stream using the static class DataStreamLoader</span>
<span class="pl-k">DataStream&lt;<span class="pl-smi">DataInstance</span>&gt;</span> data <span class="pl-k">=</span> 
                   <span class="pl-smi">DataStreamLoader</span><span class="pl-k">.</span>openFromFile(<span class="pl-s"><span class="pl-pds">"</span>datasets/WasteIncineratorSample.arff<span class="pl-pds">"</span></span>);

<span class="pl-c">//We create a ParallelSVB object</span>
<span class="pl-smi">ParallelSVB</span> parameterLearningAlgorithm <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">ParallelSVB</span>();

<span class="pl-c">//We fix the number of cores we want to exploit</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setNCores(<span class="pl-c1">4</span>);

<span class="pl-c">//We fix the DAG structure, which is a Naive Bayes with a </span>
<span class="pl-c">//global latent binary variable</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setDAG(<span class="pl-smi">StreamingVMPExample</span><span class="pl-k">.</span>getHiddenNaiveBayesStructure(data));


<span class="pl-c">//We fix the size of the window</span>
parameterLearningAlgorithm<span class="pl-k">.</span>getSVBEngine()<span class="pl-k">.</span>setWindowsSize(<span class="pl-c1">100</span>);

<span class="pl-c">//We can activate the output</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setOutput(<span class="pl-c1">true</span>);

<span class="pl-c">//We set the data which is going to be used for leaning the parameters</span>
parameterLearningAlgorithm<span class="pl-k">.</span>setDataStream(data);

<span class="pl-c">//We perform the learning</span>
parameterLearningAlgorithm<span class="pl-k">.</span>runLearning();

<span class="pl-c">//And we get the model</span>
<span class="pl-smi">BayesianNetwork</span> bnModel <span class="pl-k">=</span> parameterLearningAlgorithm<span class="pl-k">.</span>getLearntBayesianNetwork();

<span class="pl-c">//We print the model</span>
<span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(bnModel<span class="pl-k">.</span>toString());</pre></div>

<p><a href="#documentation">[Back to Top]</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/amidst/toolbox">AMIDST Toolbox 1.0</a> is maintained by <a href="https://github.com/amidst">amidst</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-66233470-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
